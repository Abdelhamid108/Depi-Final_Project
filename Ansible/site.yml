---
# -----------------------------------------------------------------------------
# Master Playbook: site.yml
# -----------------------------------------------------------------------------
# This playbook orchestrates the entire configuration management process.
# It executes a sequence of specialized playbooks to provision the infrastructure:
# 1. Initialization (Updates, Tools)
# 2. Docker Installation
# 3. Jenkins Agent Configuration
# 4. Jenkins Master Setup
# 5. Kubernetes Cluster Setup
# -----------------------------------------------------------------------------

# Setup phase: Gathers facts from all hosts to be used in subsequent plays
- name: Setup and Fact Gathering
  hosts: all
  gather_facts: yes

# Import playbooks in the defined execution order
- import_playbook: ./playbooks/initialization.yml     # Updates system cache, installs git, vim, etc.
- import_playbook: ./playbooks/docker_installation.yml # Installs Docker runtime on all nodes.
- import_playbook: ./playbooks/jenkins_agents_setup.yml # Configures nodes to act as Jenkins agents.
- import_playbook: ./playbooks/jenkins_master_setup.yml # Deploys and configures the Jenkins master server.
- import_playbook: ./playbooks/k8s_cluster_setup.yml    # Initializes the Kubernetes cluster (Master & Workers).

